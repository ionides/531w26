
We consider data $y_{1:415}$ where $y_n$ is the time interval, in milliseconds, between the $n$th and $(n+1)$th firing event for a monkey neuron.
Let $z_n = \log(y_n)$, with $\log$ being the natural logarithm.
A smoothed periodogram of $z_{1:415}$ is shown below.
Units of frequency are the default value in R, i.e., cycles per unit observation.
We see a peak at a frequency of approximately 0.07.

```{python}
#| label: q5_01_monkey_log_periodogram
#| echo: false
#| fig-width: 6
#| fig-height: 4
import numpy as np
import matplotlib.pyplot as plt
from scipy import signal

# Read neuron data
N2a = np.loadtxt("data/akira2a.asc")
# Process: take differences, filter values < 10000, convert to milliseconds
x = np.diff(N2a)
x = x[x < 10000] / 10  # units: milliseconds
z = np.log(x)

# Compute smoothed periodogram using Welch's method
# R's spectrum() with spans=c(11,9,13) does smoothing
# Welch's method provides similar smoothing via windowing
freq, psd = signal.welch(z, fs=1.0, nperseg=min(256, len(z)//4),
                          scaling='spectrum', detrend='linear')

# Plot
fig, ax = plt.subplots(figsize=(6, 4))
ax.plot(freq, 10*np.log10(psd))  # Convert to dB scale
ax.set_xlabel('frequency')
ax.set_ylabel('spectrum (dB)')
ax.set_xlim(0, 0.5)
plt.tight_layout()
plt.show()
```

Which if the following is the best inference from this figure

A. Transitions between rapid neuron firing (short intervals between firing) and slow neuron firing (long intervals between firing) occur every $1/0.07\approx 14$ firing events.

B. The neuron has a characteristic duration between firing events of $1/0.07 \approx 14$  milliseconds.

C. The neuron has a characteristic duration between firing events of $1/\exp(0.07) \approx 0.9$ milliseconds.

