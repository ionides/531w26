
We consider data $y_{1:415}$ where $y_n$ is the time interval, in milliseconds, between the $n$th and $(n+1)$th firing event for a monkey neuron.
Let $z_n = \log(y_n)$, with $\log$ being the natural logarithm.
A smoothed periodogram of $z_{1:415}$ is shown below.
Units of frequency are the default value in R, i.e., cycles per unit observation.
We see a peak at a frequency of approximately 0.07.

```{python}
#| label: q5_01_monkey_log_periodogram
#| echo: false
#| fig-width: 6
#| fig-height: 4
import numpy as np
import matplotlib.pyplot as plt
from scipy import signal
from scipy.stats import chi2

# Read neuron data
N2a = np.loadtxt("data/akira2a.asc")
# Process: take differences, filter values < 10000, convert to milliseconds
x = np.diff(N2a)
x = x[x < 10000] / 10  # units: milliseconds
z = np.log(x)

# Compute smoothed periodogram using Welch's method
nperseg=64
freqs, psd = signal.welch(z, fs=1.0, nperseg=nperseg,
                          scaling='spectrum', detrend='linear')

# Calculate Degrees of Freedom (nu) using a standard approximation
N = len(z)
K = N // (nperseg // 2) - 1
nu = 2 * K
# Calculate 95% Confidence Intervals
alpha = 0.05
lower_mult = nu / chi2.ppf(1 - alpha / 2, nu)
upper_mult = nu / chi2.ppf(alpha / 2, nu)
psd_low = psd * lower_mult
psd_high = psd * upper_mult

# Plot
fig, ax = plt.subplots(figsize=(6, 4))
plt.semilogy(freqs[1:], psd[1:], label='Welch PSD (Smoothed)')
plt.fill_between(freqs[1:], psd_low[1:], psd_high[1:], color='gray', 
    alpha=0.3, label='95% CI')
plt.xlabel('Frequency [cycles per observation]')
plt.ylabel('Power spectral density')
plt.legend()
plt.show()
```

Which if the following is the best inference from this figure

A. Transitions between rapid neuron firing (short intervals between firing) and slow neuron firing (long intervals between firing) occur every $1/0.07\approx 14$ firing events.

B. The neuron has a characteristic duration between firing events of $1/0.07 \approx 14$  milliseconds.

C. The neuron has a characteristic duration between firing events of $1/\exp(0.07) \approx 0.9$ milliseconds.

