
```{python}
#| label: q4_02_read_mers
#| echo: false
#| fig-width: 7
#| fig-height: 2.5
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats
from statsmodels.tsa.arima.model import ARIMA

# Code adapted from
# https://ionides.github.io/531w24/final_project/project15
mers_df = pd.read_csv("data/mers.csv", comment='#')
saudi = mers_df[mers_df['Region'] == 'Saudi Arabia']
mers = saudi['New Cases'].values
year = saudi['Year'].values + (saudi['Week'].values - 1) / 52
mask = year > 2013.5
mers = mers[mask]
year = year[mask]

# Fit ARMA(2,2)
arma22 = ARIMA(mers, order=(2, 0, 2)).fit()

# Create two-panel plot
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(7, 2.5))

# Panel A: Time series
ax1.plot(year, mers, 'k-', linewidth=1)
ax1.set_xlabel('Year')
ax1.set_ylabel('MERS Reports')
ax1.text(2012.1, 80, 'A', fontsize=16)

# Panel B: Q-Q plot
stats.probplot(arma22.resid, dist="norm", plot=ax2)
ax2.set_title('')
ax2.text(-4.2, 35, 'B', fontsize=16)

plt.tight_layout()
plt.show()
```

\(A) Weekly cases of Middle East Respiratory Syndome (MERS) in Saudi Arabia. (B) a normal quantile plot of the residuals from fitting an ARMA(2,2) model to these data using `arima()`. What is the best interpretation of (B)?

A: We should consider fitting a long-tailed error distribution, such as the t distribution.\
B: The model is missing seasonality, which could be critical in this situation.\
C: For using ARMA methods, these data should be log-transformed to make a linear Gaussian approximation more appropriate.\
D: The normal quantile plot shows a long-tailed distribution, but this is not a major problem. We have over 300 data points, so the central limit theorem should hold for parameter estimates.\
E: The normal quantile plot shows long tails, but with the right tail noticeably longer than the left tail. We should consider an asymmetric error distribution.\
F: We should not interpret (B) before testing for stationarity. First run `adf.test()` and, if the null hypothesis is not rejected, recalculate (B) when fitting to the differenced data.




