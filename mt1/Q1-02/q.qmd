
```{python}
#| label: q1_02_timeplot
#| echo: false
#| fig-width: 6
#| fig-height: 3.5
import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import norm

np.random.seed(33)
N = 1000
sd1 = np.ones(N)
events = (np.random.uniform(size=N) < 5/N).astype(float)
sigma = 20
amplitude = 10

# Create filter using normal density (equivalent to R's dnorm)
filter_length = int(5 * sigma)
filter_seq = np.linspace(-2.5*sigma, 2.5*sigma, filter_length)
filter_weights = norm.pdf(filter_seq, scale=sigma) * sigma * amplitude

# Apply circular convolution (equivalent to R's filter with circular=T)
sd2 = sd1 + np.convolve(events, filter_weights, mode='same')

# Generate time series with time-varying variance
Y = np.random.normal(0, sd2)

# Plot
fig, ax = plt.subplots(figsize=(6, 3.5))
ax.plot(Y, linewidth=0.5)
ax.set_xlabel('')
ax.set_ylabel('y')
plt.tight_layout()
plt.show()
```

Consider the time series plotted above. Which of the below is the most accurate statement about stationarity?

A. The plot shows that the data are clearly non-stationary. We could make a formal hypothesis test to confirm that, but it would not be insightful. To describe the data using a statistical model, we will need to develop a model with non-constant variance.

B. The sample variance is evidently different in different time intervals. However, we should not conclude that the underlying data generating mechanism is non-stationary before making a formal statistical test of equality of variances between the time regions that have lower sample variance and the regions that have higher sample variance. Visual impressions without a formal hypothesis test can be deceptive.

C. A model with randomly changing variance looks appropriate for these data. Since the variance for such a model is time-varying, the model must be non-stationary.

D. A model with randomly changing variance looks appropriate for these data. Despite the variance for such a model being time-varying, the model is stationary.

E. The sample variance is evidently different in different time intervals. An appropriate next step to investigate stationary would be to plot the sample autocorrelation function for different intervals to see if the dependence between time points is also time-varying.


